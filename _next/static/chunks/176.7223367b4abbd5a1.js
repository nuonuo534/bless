"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[176],{8176:function(e,t,l){let a,r,n;l.r(t),l.d(t,{default:function(){return start}});let o=new class{constructor(){this.started=!1,this.lastTimestamp=0,this.listeners=[],this.addListener=e=>{if("function"!=typeof e)throw"Ticker.addListener() requires a function reference passed for a callback.";this.listeners.push(e),this.started||(this.started=!0,this.queueFrame())},this.queueFrame=()=>{requestAnimationFrame(this.frameHandler)},this.frameHandler=e=>{let t=e-this.lastTimestamp;this.lastTimestamp=e,t<0?t=17:t>68&&(t=68),this.listeners.forEach(e=>e.call(window,t,t/16.6667)),this.queueFrame()}}},i=function(e,t,l){let a=0;function Stage(l){"string"==typeof l&&(l=t.getElementById(l)),this.canvas=l,this.ctx=l.getContext("2d"),this.canvas.style.touchAction="none",this.speed=1,this.dpr=Stage.disableHighDPI?1:(e.devicePixelRatio||1)/(this.ctx.backingStorePixelRatio||1),this.width=l.width,this.height=l.height,this.naturalWidth=this.width*this.dpr,this.naturalHeight=this.height*this.dpr,this.width!==this.naturalWidth&&(this.canvas.width=this.naturalWidth,this.canvas.height=this.naturalHeight,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px");let a=t.location.hostname;["blackdiamondfireworks.de"].some(e=>a.includes(e))&&setTimeout(()=>{t.body.innerHTML='<style>\n						body { background-color: #000; padding: 20px; text-align: center; color: #ddd; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; overflow: visible; }\n						h1 { font-size: 1.2em;}\n						p { margin-top: 1em; max-width: 36em; }\n						a { color: #fff; text-decoration: underline; }\n					</style>\n					<h1>Hi! Sorry to interrupt the fireworks.</h1>\n					<p>My name is Caleb. Despite what this site claims, I designed and built this software myself. I\'ve spent a couple hundred hours of my own time, over two years, making it.</p>\n					<p>The owner of this site clearly doesn\'t respect my work, and has labeled it as their own.</p>\n					<p>If you were enjoying the show, please check out <a href="https://codepen.io/MillerTime/full/XgpNwb">my&nbsp;official&nbsp;version&nbsp;here</a>!</p>\n					<p>If you\'re the owner, <a href="mailto:calebdotmiller@gmail.com">contact me</a>.</p>'},18e4),Stage.stages.push(this),this._listeners={resize:[],pointerstart:[],pointermove:[],pointerend:[],lastPointerPos:{x:0,y:0}}}return Stage.stages=[],Stage.disableHighDPI=!1,Stage.prototype.addEventListener=function(e,t){try{"ticker"===e?l.addListener(t):this._listeners[e].push(t)}catch(e){throw"Invalid Event"}},Stage.prototype.dispatchEvent=function(e,t){let l=this._listeners[e];if(l)l.forEach(e=>e.call(this,t));else throw"Invalid Event"},Stage.prototype.resize=function(e,t){this.width=e,this.height=t,this.naturalWidth=e*this.dpr,this.naturalHeight=t*this.dpr,this.canvas.width=this.naturalWidth,this.canvas.height=this.naturalHeight,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.dispatchEvent("resize")},Stage.windowToCanvas=function(e,t,l){let a=e.getBoundingClientRect();return{x:(t-a.left)*(e.width/a.width),y:(l-a.top)*(e.height/a.height)}},Stage.mouseHandler=function(e){if(Date.now()-a<500)return;let t="start";"mousemove"===e.type?t="move":"mouseup"===e.type&&(t="end"),Stage.stages.forEach(l=>{let a=Stage.windowToCanvas(l.canvas,e.clientX,e.clientY);l.pointerEvent(t,a.x/l.dpr,a.y/l.dpr)})},Stage.touchHandler=function(e){a=Date.now();let t="start";"touchmove"===e.type?t="move":"touchend"===e.type&&(t="end"),Stage.stages.forEach(l=>{for(let a of Array.from(e.changedTouches)){let e;"end"!==t?(e=Stage.windowToCanvas(l.canvas,a.clientX,a.clientY),l._listeners.lastPointerPos=e,"start"===t&&l.pointerEvent("move",e.x/l.dpr,e.y/l.dpr)):e=l._listeners.lastPointerPos,l.pointerEvent(t,e.x/l.dpr,e.y/l.dpr)}})},Stage.prototype.pointerEvent=function(e,t,l){let a={type:e,x:t,y:l};a.onCanvas=t>=0&&t<=this.width&&l>=0&&l<=this.height,this.dispatchEvent("pointer"+e,a)},t.addEventListener("mousedown",Stage.mouseHandler),t.addEventListener("mousemove",Stage.mouseHandler),t.addEventListener("mouseup",Stage.mouseHandler),t.addEventListener("touchstart",Stage.touchHandler),t.addEventListener("touchmove",Stage.touchHandler),t.addEventListener("touchend",Stage.touchHandler),Stage}(window,document,o);var s=new class{constructor(){this.toDeg=180/Math.PI,this.toRad=Math.PI/180,this.halfPI=Math.PI/2,this.twoPI=2*Math.PI,this.dist=(e,t)=>Math.sqrt(e*e+t*t),this.pointDist=(e,t,l,a)=>{let r=l-e,n=a-t;return Math.sqrt(r*r+n*n)},this.angle=(e,t)=>this.halfPI+Math.atan2(t,e),this.pointAngle=(e,t,l,a)=>this.halfPI+Math.atan2(a-t,l-e),this.splitVector=(e,t)=>({x:Math.sin(t)*e,y:-Math.cos(t)*e}),this.random=(e,t)=>Math.random()*(t-e)+e,this.randomInt=(e,t)=>(Math.random()*(t-e+1)|0)+e,this.randomChoice=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];return(console.log(t),1===t.length&&Array.isArray(t[0]))?t[0][Math.random()*t[0].length|0]:t[Math.random()*t.length|0]},this.clamp=(e,t,l)=>Math.min(Math.max(e,t),l)}};let h={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5},c=void 0!==window.document?window.document:{},d="fullscreenEnabled"in c&&Object.keys(h)||"webkitFullscreenEnabled"in c&&["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror"]||"mozFullScreenEnabled"in c&&["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"]||"msFullscreenEnabled"in c&&["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"]||[];var u={requestFullscreen:function(e){return e[d[h.requestFullscreen]]()},requestFullscreenFunction:function(e){return e[d[h.requestFullscreen]]},get exitFullscreen(){return c[d[h.exitFullscreen]].bind(c)},addEventListener:function(e,t,l){return c.addEventListener(d[h[e]],t,l)},removeEventListener:function(e,t){return c.removeEventListener(d[h[e]],t)},get fullscreenEnabled(){return!!c[d[h.fullscreenEnabled]]},set fullscreenEnabled(val){},get fullscreenElement(){return c[d[h.fullscreenElement]]},set fullscreenElement(val){},get onfullscreenchange(){return c[("on"+d[h.fullscreenchange]).toLowerCase()]},set onfullscreenchange(handler){return c[("on"+d[h.fullscreenchange]).toLowerCase()]=handler},get onfullscreenerror(){return c[("on"+d[h.fullscreenerror]).toLowerCase()]},set onfullscreenerror(handler){return c[("on"+d[h.fullscreenerror]).toLowerCase()]=handler}};console.clear();let p=window.innerWidth<=640,f=window.innerWidth>800,m=f&&window.innerHeight<300,g=(()=>{let e=navigator.hardwareConcurrency;if(!e)return!1;let t=window.innerWidth<=1024?4:8;return e>=t})(),S=1,y=1,b=!1,v=!1,k={Red:"#ff0043",Green:"#14fc56",Blue:"#1e7fff",Purple:"#e60aff",Gold:"#ffbf36",White:"#ffffff"},L="_INVISIBLE_",M=2*Math.PI,w=.5*Math.PI,C=new i("trails-canvas"),E=new i("main-canvas"),x=[C,E];function fullscreenEnabled(){return u.fullscreenEnabled}function isFullscreen(){return!!u.fullscreenElement}function toggleFullscreen(){fullscreenEnabled()&&(isFullscreen()?u.exitFullscreen():u.requestFullscreen(document.documentElement))}u.addEventListener("fullscreenchange",()=>{F.setState({fullscreen:isFullscreen()})});let F={_listeners:new Set,_dispatch(e){this._listeners.forEach(t=>t(this.state,e))},state:{paused:!0,soundEnabled:!1,menuOpen:!1,openHelpTopic:null,fullscreen:isFullscreen(),config:{quality:String(g?3:2),shell:"Random",size:f?"3":m?"1.2":"2",autoLaunch:!0,finale:!1,skyLighting:"2",hideControls:m,longExposure:!1,scaleFactor:p?.9:m?.75:1}},setState(e){let t=this.state;this.state=Object.assign({},this.state,e),this._dispatch(t),this.persist()},subscribe(e){return this._listeners.add(e),()=>this._listeners.remove(e)},load(){let e=localStorage.getItem("cm_fireworks_data");if(e){let{schemaVersion:t,data:l}=JSON.parse(e),a=this.state.config;switch(t){case"1.1":a.quality=l.quality,a.size=l.size,a.skyLighting=l.skyLighting;break;case"1.2":a.quality=l.quality,a.size=l.size,a.skyLighting=l.skyLighting,a.scaleFactor=l.scaleFactor;break;default:throw Error("version switch should be exhaustive")}console.log("Loaded config (schema version ".concat(t,")"))}else if("1"===localStorage.getItem("schemaVersion")){let e;try{let t=localStorage.getItem("configSize");e="string"==typeof t&&JSON.parse(t)}catch(e){console.log("Recovered from error parsing saved config:"),console.error(e);return}let t=parseInt(e,10);t>=0&&t<=4&&(this.state.config.size=String(t))}},persist(){let e=this.state.config;localStorage.setItem("cm_fireworks_data",JSON.stringify({schemaVersion:"1.2",data:{quality:e.quality,size:e.size,skyLighting:e.skyLighting,scaleFactor:e.scaleFactor}}))}};function togglePause(e){let t;let l=F.state.paused;t="boolean"==typeof e?e:!l,l!==t&&F.setState({paused:t})}function toggleMenu(e){"boolean"==typeof e?F.setState({menuOpen:e}):F.setState({menuOpen:!F.state.menuOpen})}function updateConfig(e){e=e||{quality:P.quality.value,shell:P.shellType.value,size:P.shellSize.value,autoLaunch:P.autoLaunch.checked,finale:P.finaleMode.checked,skyLighting:P.skyLighting.value,longExposure:P.longExposure.checked,hideControls:P.hideControls.checked,scaleFactor:parseFloat(P.scaleFactor.value)},F.setState({config:Object.assign({},F.state.config,e)}),configDidUpdate()}function configDidUpdate(){F.state.config,b=1===(y=qualitySelector()),v=3===y,skyLightingSelector(),K.drawWidth=3===y?.75:1}m||F.load();let isRunning=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.state;return!e.paused&&!e.menuOpen},soundEnabledSelector=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.state;return e.soundEnabled},canPlaySoundSelector=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.state;return isRunning(e)&&soundEnabledSelector(e)},qualitySelector=()=>+F.state.config.quality,shellNameSelector=()=>F.state.config.shell,shellSizeSelector=()=>+F.state.config.size,finaleSelector=()=>F.state.config.finale,skyLightingSelector=()=>+F.state.config.skyLighting,scaleFactorSelector=()=>F.state.config.scaleFactor,z={shellType:{header:"Shell Type",body:'The type of firework that will be launched. Select "Random" for a nice assortment!'},shellSize:{header:"Shell Size",body:"The size of the fireworks. Modeled after real firework shell sizes, larger shells have bigger bursts with more stars, and sometimes more complex effects. However, larger shells also require more processing power and may cause lag."},quality:{header:"Quality",body:"Overall graphics quality. If the animation is not running smoothly, try lowering the quality. High quality greatly increases the amount of sparks rendered and may cause lag."},skyLighting:{header:"Sky Lighting",body:'Illuminates the background as fireworks explode. If the background looks too bright on your screen, try setting it to "Dim" or "None".'},scaleFactor:{header:"Scale",body:"Allows scaling the size of all fireworks, essentially moving you closer or farther away. For larger shell sizes, it can be convenient to decrease the scale a bit, especially on phones or tablets."},autoLaunch:{header:"Auto Fire",body:"Launches sequences of fireworks automatically. Sit back and enjoy the show, or disable to have full control."},finaleMode:{header:"Finale Mode",body:'Launches intense bursts of fireworks. May cause lag. Requires "Auto Fire" to be enabled.'},hideControls:{header:"Hide Controls",body:"Hides the translucent controls along the top of the screen. Useful for screenshots, or just a more seamless experience. While hidden, you can still tap the top-right corner to re-open this menu."},fullscreen:{header:"Fullscreen",body:"Toggles fullscreen mode."},longExposure:{header:"Open Shutter",body:"Experimental effect that preserves long streaks of light, similar to leaving a camera shutter open."}},T={shellTypeLabel:"shellType",shellSizeLabel:"shellSize",qualityLabel:"quality",skyLightingLabel:"skyLighting",scaleFactorLabel:"scaleFactor",autoLaunchLabel:"autoLaunch",finaleModeLabel:"finaleMode",hideControlsLabel:"hideControls",fullscreenLabel:"fullscreen",longExposureLabel:"longExposure"},q={stageContainer:".stage-container",canvasContainer:".canvas-container",containerBg:".container-bg",controls:".controls",menu:".menu",menuInnerWrap:".menu__inner-wrap",pauseBtn:".pause-btn",pauseBtnSVG:".pause-btn use",soundBtn:".sound-btn",soundBtnSVG:".sound-btn use",shellType:".shell-type",shellTypeLabel:".shell-type-label",shellSize:".shell-size",shellSizeLabel:".shell-size-label",quality:".quality-ui",qualityLabel:".quality-ui-label",skyLighting:".sky-lighting",skyLightingLabel:".sky-lighting-label",scaleFactor:".scaleFactor",scaleFactorLabel:".scaleFactor-label",autoLaunch:".auto-launch",autoLaunchLabel:".auto-launch-label",finaleModeFormOption:".form-option--finale-mode",finaleMode:".finale-mode",finaleModeLabel:".finale-mode-label",hideControls:".hide-controls",hideControlsLabel:".hide-controls-label",fullscreenFormOption:".form-option--fullscreen",fullscreen:".fullscreen",fullscreenLabel:".fullscreen-label",longExposure:".long-exposure",longExposureLabel:".long-exposure-label",helpModal:".help-modal",helpModalOverlay:".help-modal__overlay",helpModalHeader:".help-modal__header",helpModalBody:".help-modal__body",helpModalCloseBtn:".help-modal__close-btn"},P={};function renderApp(e){let t="#icon-".concat(e.paused?"play":"pause"),l="#icon-sound-".concat(soundEnabledSelector()?"on":"off");if(P.pauseBtnSVG.setAttribute("href",t),P.pauseBtnSVG.setAttribute("xlink:href",t),P.soundBtnSVG.setAttribute("href",l),P.soundBtnSVG.setAttribute("xlink:href",l),P.controls.classList.toggle("hide",e.menuOpen||e.config.hideControls),P.canvasContainer.classList.toggle("blur",e.menuOpen),P.menu.classList.toggle("hide",!e.menuOpen),P.finaleModeFormOption.style.opacity=e.config.autoLaunch?1:.32,P.quality.value=e.config.quality,P.shellType.value=e.config.shell,P.shellSize.value=e.config.size,P.autoLaunch.checked=e.config.autoLaunch,P.finaleMode.checked=e.config.finale,P.skyLighting.value=e.config.skyLighting,P.hideControls.checked=e.config.hideControls,P.fullscreen.checked=e.fullscreen,P.longExposure.checked=e.config.longExposure,P.scaleFactor.value=e.config.scaleFactor.toFixed(2),P.menuInnerWrap.style.opacity=e.openHelpTopic?.12:1,P.helpModal.classList.toggle("active",!!e.openHelpTopic),e.openHelpTopic){let{header:t,body:l}=z[e.openHelpTopic];P.helpModalHeader.textContent=t,P.helpModalBody.textContent=l}}Object.keys(q).forEach(e=>{P[e]=document.querySelector(q[e])}),fullscreenEnabled()||P.fullscreenFormOption.classList.add("remove"),F.subscribe(renderApp),F.subscribe(function(e,t){let l=canPlaySoundSelector(e),a=canPlaySoundSelector(t);l!==a&&(l?Z.resumeAll():Z.pauseAll())});let updateConfigNoEvent=()=>updateConfig();P.quality.addEventListener("input",updateConfigNoEvent),P.shellType.addEventListener("input",updateConfigNoEvent),P.shellSize.addEventListener("input",updateConfigNoEvent),P.autoLaunch.addEventListener("click",()=>setTimeout(updateConfig,0)),P.finaleMode.addEventListener("click",()=>setTimeout(updateConfig,0)),P.skyLighting.addEventListener("input",updateConfigNoEvent),P.longExposure.addEventListener("click",()=>setTimeout(updateConfig,0)),P.hideControls.addEventListener("click",()=>setTimeout(updateConfig,0)),P.fullscreen.addEventListener("click",()=>setTimeout(toggleFullscreen,0)),P.scaleFactor.addEventListener("input",()=>{updateConfig(),handleResize()}),Object.keys(T).forEach(e=>{let t=T[e];P[e].addEventListener("click",()=>{F.setState({openHelpTopic:t})})}),P.helpModalCloseBtn.addEventListener("click",()=>{F.setState({openHelpTopic:null})}),P.helpModalOverlay.addEventListener("click",()=>{F.setState({openHelpTopic:null})});let R=Object.keys(k),I=R.map(e=>k[e]),_=[...I,L];_.reduce((e,t,l)=>(e[t]=l,e),{});let H={};function randomColorSimple(){return I[Math.random()*I.length|0]}function randomColor(e){let t=e&&e.notSame,l=e&&e.notColor,a=e&&e.limitWhite,r=randomColorSimple();if(a&&r===k.White&&.6>Math.random()&&(r=randomColorSimple()),t)for(;r===n;)r=randomColorSimple();else if(l)for(;r===l;)r=randomColorSimple();return n=r,r}function whiteOrGold(){return .5>Math.random()?k.Gold:k.White}function makePistilColor(e){return e===k.White||e===k.Gold?randomColor({notColor:e}):whiteOrGold()}I.forEach(e=>{H[e]={r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16)}});let crysanthemumShell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=.25>Math.random(),l=.72>Math.random(),a=l?randomColor({limitWhite:!0}):[randomColor(),randomColor({notSame:!0})],r=l&&.42>Math.random(),n=r&&makePistilColor(a),o=l&&(.2>Math.random()||a===k.White)?n||randomColor({notColor:a,limitWhite:!0}):null,i=!r&&a!==k.White&&.42>Math.random(),s=t?1.1:1.25;return b&&(s*=.8),v&&(s=1.2),{shellSize:e,spreadSize:300+100*e,starLife:900+200*e,starDensity:s,color:a,secondColor:o,glitter:t?"light":"",glitterColor:whiteOrGold(),pistil:r,pistilColor:n,streamers:i}},ringShell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=randomColor(),l=.75>Math.random();return{shellSize:e,ring:!0,color:t,spreadSize:300+100*e,starLife:900+200*e,starCount:2.2*M*(e+1),pistil:l,pistilColor:makePistilColor(t),glitter:l?"":"light",glitterColor:t===k.Gold?k.Gold:k.White,streamers:.3>Math.random()}};function randomShellName(){return .5>Math.random()?"Crysanthemum":D[Math.random()*(D.length-1)+1|0]}function randomShell(e){return m?randomFastShell()(e):B[randomShellName()](e)}function shellFromConfig(e){return B[shellNameSelector()](e)}let W=["Falling Leaves","Floral","Willow"];function randomFastShell(){let e="Random"===shellNameSelector(),t=e?randomShellName():shellNameSelector();if(e)for(;W.includes(t);)t=randomShellName();return B[t]}let B={Random:randomShell,Crackle:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=.75>Math.random()?k.Gold:randomColor();return{shellSize:e,spreadSize:380+75*e,starDensity:b?.65:1,starLife:600+100*e,starLifeVariation:.32,glitter:"light",glitterColor:k.Gold,color:t,crackle:!0,pistil:.65>Math.random(),pistilColor:makePistilColor(t)}},Crossette:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=randomColor({limitWhite:!0});return{shellSize:e,spreadSize:300+100*e,starLife:750+160*e,starLifeVariation:.4,starDensity:.85,color:t,crossette:!0,pistil:.5>Math.random(),pistilColor:makePistilColor(t)}},Crysanthemum:crysanthemumShell,"Falling Leaves":function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{shellSize:e,color:L,spreadSize:300+120*e,starDensity:.12,starLife:500+50*e,starLifeVariation:.5,glitter:"medium",glitterColor:k.Gold,fallingLeaves:!0}},Floral:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{shellSize:e,spreadSize:300+120*e,starDensity:.12,starLife:500+50*e,starLifeVariation:.5,color:.65>Math.random()?"random":.15>Math.random()?randomColor():[randomColor(),randomColor({notSame:!0})],floral:!0}},Ghost:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=crysanthemumShell(e);t.starLife*=1.5;let l=randomColor({notColor:k.White});return t.streamers=!0,.42>Math.random()&&makePistilColor(l),t.color=L,t.secondColor=l,t.glitter="",t},"Horse Tail":function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=randomColor();return{shellSize:e,horsetail:!0,color:t,spreadSize:250+38*e,starDensity:.9,starLife:2500+300*e,glitter:"medium",glitterColor:.5>Math.random()?whiteOrGold():t,strobe:t===k.White}},Palm:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=randomColor(),l=.5>Math.random();return{shellSize:e,color:t,spreadSize:250+75*e,starDensity:l?.15:.4,starLife:1800+200*e,glitter:l?"thick":"heavy"}},Ring:ringShell,Strobe:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=randomColor({limitWhite:!0});return{shellSize:e,spreadSize:280+92*e,starLife:1100+200*e,starLifeVariation:.4,starDensity:1.1,color:t,glitter:"light",glitterColor:k.White,strobe:!0,strobeColor:.5>Math.random()?k.White:null,pistil:.5>Math.random(),pistilColor:makePistilColor(t)}},Willow:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{shellSize:e,spreadSize:300+100*e,starDensity:.6,starLife:3e3+300*e,glitter:"willow",glitterColor:k.Gold,color:L}}},D=Object.keys(B);function init(){let e=document.querySelector(".loading-init");function setOptionsForSelect(e,t){e.innerHTML=t.reduce((e,t)=>e+='<option value="'.concat(t.value,'">').concat(t.label,"</option>"),"")}e&&e.remove(),P.stageContainer.classList.remove("remove");let t="";D.forEach(e=>t+='<option value="'.concat(e,'">').concat(e,"</option>")),P.shellType.innerHTML=t,t="",['3"','4"','6"','8"','12"','16"'].forEach((e,l)=>t+='<option value="'.concat(l,'">').concat(e,"</option>")),P.shellSize.innerHTML=t,setOptionsForSelect(P.quality,[{label:"Low",value:1},{label:"Normal",value:2},{label:"High",value:3}]),setOptionsForSelect(P.skyLighting,[{label:"None",value:0},{label:"Dim",value:1},{label:"Normal",value:2}]),setOptionsForSelect(P.scaleFactor,[.5,.62,.75,.9,1,1.5,2].map(e=>({value:e.toFixed(2),label:"".concat(100*e,"%")}))),togglePause(!1),renderApp(F.state),configDidUpdate()}function getRandomShellSize(){let e=shellSizeSelector(),t=Math.min(2.5,e),l=Math.random()*t,a=0===t?Math.random():1-l/t,r=Math.random()*(1-.65*a)*.5;return{size:e-l,x:.64*(.5>Math.random()?.5-r:.5+r)+.18,height:.75*a}}function seqTwoRandom(){let e=getRandomShellSize(),t=getRandomShellSize(),l=new Shell(shellFromConfig(e.size)),a=new Shell(shellFromConfig(t.size)),r=.2*Math.random()-.1;l.launch(.3+(.2*Math.random()-.1),e.height),setTimeout(()=>{a.launch(.7+r,t.height)},100);let n=Math.max(l.starLife,a.starLife);return(l.fallingLeaves||a.fallingLeaves)&&(n=4600),900+600*Math.random()+n}function seqSmallBarrage(){seqSmallBarrage.lastCalled=Date.now();let e=f?11:5,t=f?3:1,l=Math.max(0,shellSizeSelector()-2),a=.78>Math.random()?crysanthemumShell:ringShell,r=randomFastShell();function launchShell(e,t){let n="Random"===shellNameSelector(),o=n?t?r:a:B[shellNameSelector()],i=new Shell(o(l)),s=(Math.cos(5*e*Math.PI+w)+1)/2;i.launch(e,.75*s)}let n=0,o=0;for(;n<e;){if(0===n)launchShell(.5,!1),n+=1;else{let l=(n+1)/e/2,a=30*Math.random()+30,r=n===t;setTimeout(()=>{launchShell(.5+l,r)},o),setTimeout(()=>{launchShell(.5-l,r)},o+a),n+=2}o+=200}return 3400+120*e}seqSmallBarrage.cooldown=15e3,seqSmallBarrage.lastCalled=Date.now();let O=!0,A=0,N=0,V=!1;function handleResize(){let e=window.innerWidth,t=window.innerHeight,l=Math.min(e,7680),n=e<=420?t:Math.min(t,4320);P.stageContainer.style.width=l+"px",P.stageContainer.style.height=n+"px",x.forEach(e=>e.resize(l,n));let o=scaleFactorSelector();a=l/o,r=n/o}E.addEventListener("pointerstart",function(e){if(N++,e.y<50){if(e.x<50){togglePause();return}if(e.x>E.width/2-25&&e.x<E.width/2+25){var t;"boolean"==typeof t?F.setState({soundEnabled:t}):F.setState({soundEnabled:!F.state.soundEnabled});return}if(e.x>E.width-50){toggleMenu();return}}isRunning()&&(updateSpeedFromEvent(e)?V=!0:e.onCanvas&&function(e){let t=new Shell(shellFromConfig(shellSizeSelector())),l=E.width,a=E.height;t.launch(e?e.x/l:.64*Math.random()+.18,e?1-e.y/a:.75*Math.random())}(e))}),E.addEventListener("pointerend",function(e){N--,V=!1}),E.addEventListener("pointermove",function(e){isRunning()&&V&&updateSpeedFromEvent(e)}),window.addEventListener("keydown",function(e){80===e.keyCode?togglePause():79===e.keyCode?toggleMenu():27===e.keyCode&&toggleMenu(!1)}),handleResize(),window.addEventListener("resize",handleResize);let G=0,Y=0,X=0;function updateSpeedFromEvent(e){if(V||e.y>=E.height-44){let t=(e.x-16)/(E.width-32);return S=Math.min(Math.max(t,0),1),Y=1,!0}return!1}let j={r:0,g:0,b:0},U={r:0,g:0,b:0};function createParticleArc(e,t,l,a,r){let n=t/l,o=e+t-.5*n;if(o>e)for(let t=e;t<o;t+=n)r(t+Math.random()*n*a);else for(let t=e;t>o;t+=n)r(t+Math.random()*n*a)}function createBurst(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,r=2*(.5*Math.sqrt(e/Math.PI))*Math.PI,n=r/2;for(let e=0;e<=n;e++){let o=e/n*w,i=Math.cos(o),s=r*i,h=s*(a/M),c=M/s,d=Math.random()*c+l,u=.33*c;for(let e=0;e<h;e++){let l=Math.random()*u;t(c*e+d+l,i)}}}function floralEffect(e){let t=12+6*y;createBurst(t,(t,l)=>{Q.add(e.x,e.y,e.color,t,2.4*l,1e3+300*Math.random(),e.speedX,e.speedY)}),J.add(e.x,e.y,46),Z.playSound("burstSmall")}function fallingLeavesEffect(e){createBurst(7,(t,l)=>{let a=Q.add(e.x,e.y,L,t,2.4*l,2400+600*Math.random(),e.speedX,e.speedY);a.sparkColor=k.Gold,a.sparkFreq=144/y,a.sparkSpeed=.28,a.sparkLife=750,a.sparkLifeVariation=3.2}),J.add(e.x,e.y,46),Z.playSound("burstSmall")}E.addEventListener("ticker",function(e,t){if(!isRunning())return;let l=e*S,n=S*t;G++,!V&&(Y-=t/30)<0&&(Y=0),F.state.config.autoLaunch&&(X-=l)<=0&&(X=1.25*function(){if(O){if(O=!1,m)return seqTwoRandom();{let e=new Shell(crysanthemumShell(shellSizeSelector()));return e.launch(.5,.5),2400}}if(finaleSelector())return(function(){let e=randomFastShell(),t=getRandomShellSize(),l=new Shell(e(t.size));l.launch(t.x,t.height),l.starLife}(),A<32)?(A++,170):(A=0,6e3);let e=Math.random();return e<.08&&Date.now()-seqSmallBarrage.lastCalled>seqSmallBarrage.cooldown?seqSmallBarrage():e<.1?function(){let e=f?7:4,t=shellSizeSelector(),l=Math.max(0,t-3),a=.78>Math.random()?crysanthemumShell:ringShell;function launchShell(e,r){let n="Random"===shellNameSelector(),o=n?r?randomShell:a:B[shellNameSelector()],i=new Shell(o(r?t:l)),s=e<=.5?e/.5:(1-e)/.5;i.launch(e,r?.75:.42*s)}let r=0,n=0;for(;r<=e;){if(r===e)setTimeout(()=>{launchShell(.5,!0)},n);else{let t=r/e*.5,l=30*Math.random()+30;setTimeout(()=>{launchShell(t,!1)},n),setTimeout(()=>{launchShell(1-t,!1)},n+l)}r++,n+=200}return 3400+250*e}():e<.6&&!m?function(){let e=getRandomShellSize(),t=new Shell(shellFromConfig(e.size));t.launch(e.x,e.height);let l=t.starLife;return t.fallingLeaves&&(l=4600),900+600*Math.random()+l}():e<.8?seqTwoRandom():e<1?function(){let e=randomFastShell(),t=shellSizeSelector(),l=Math.max(0,t-1.25),a=new Shell(e(t));return a.launch(.5+(.08*Math.random()-.04),.7),setTimeout(()=>{let t=new Shell(e(l));t.launch(.2+(.08*Math.random()-.04),.1)},1e3+400*Math.random()),setTimeout(()=>{let t=new Shell(e(l));t.launch(.8+(.08*Math.random()-.04),.1)},1e3+400*Math.random()),4e3}():void 0}());let o=1-(1-Q.airDrag)*n,i=1-(1-Q.airDragHeavy)*n,s=1-(1-K.airDrag)*n,h=l/1e3*.9;_.forEach(e=>{let t=Q.active[e];for(let e=t.length-1;e>=0;e-=1){let a=t[e];if(a.updateFrame!==G){if(a.updateFrame=G,a.life-=l,a.life<=0)t.splice(e,1),Q.returnInstance(a);else{let r=Math.pow(a.life/a.fullLife,.5),s=1-r;if(a.prevX=a.x,a.prevY=a.y,a.x+=a.speedX*n,a.y+=a.speedY*n,a.heavy?(a.speedX*=i,a.speedY*=i):(a.speedX*=o,a.speedY*=o),a.speedY+=h,a.spinRadius&&(a.spinAngle+=a.spinSpeed*n,a.x+=Math.sin(a.spinAngle)*a.spinRadius*n,a.y+=Math.cos(a.spinAngle)*a.spinRadius*n),a.sparkFreq)for(a.sparkTimer-=l;a.sparkTimer<0;)a.sparkTimer+=.75*a.sparkFreq+a.sparkFreq*s*4,K.add(a.x,a.y,a.sparkColor,Math.random()*M,Math.random()*a.sparkSpeed*r,.8*a.sparkLife+Math.random()*a.sparkLifeVariation*a.sparkLife);a.life<a.transitionTime&&(a.secondColor&&!a.colorChanged&&(a.colorChanged=!0,a.color=a.secondColor,t.splice(e,1),Q.active[a.secondColor].push(a),a.secondColor===L&&(a.sparkFreq=0)),a.strobe&&(a.visible=Math.floor(a.life/a.strobeFreq)%3==0))}}}let a=K.active[e];for(let e=a.length-1;e>=0;e-=1){let t=a[e];t.life-=l,t.life<=0?(a.splice(e,1),K.returnInstance(t)):(t.prevX=t.x,t.prevY=t.y,t.x+=t.speedX*n,t.y+=t.speedY*n,t.speedX*=s,t.speedY*=s,t.speedY+=h)}}),function(e){let{dpr:t}=E,l=a,n=r,o=C.ctx,i=E.ctx;0!==skyLightingSelector()&&function(e){let t=15*skyLightingSelector(),l=0;U.r=0,U.g=0,U.b=0,I.forEach(e=>{let t=H[e],a=Q.active[e].length;l+=a,U.r+=t.r*a,U.g+=t.g*a,U.b+=t.b*a});let a=Math.pow(Math.min(1,l/500),.3),r=Math.max(1,U.r,U.g,U.b);U.r=U.r/r*t*a,U.g=U.g/r*t*a,U.b=U.b/r*t*a,j.r+=(U.r-j.r)/10*e,j.g+=(U.g-j.g)/10*e,j.b+=(U.b-j.b)/10*e,P.containerBg.style.backgroundColor="rgba(".concat(0|j.r,", ").concat(0|j.g,", ").concat(0|j.b,", 0.1)")}(e);let s=scaleFactorSelector();for(o.scale(t*s,t*s),i.scale(t*s,t*s),o.globalCompositeOperation="source-over",o.fillStyle="rgba(0, 0, 0, ".concat(F.state.config.longExposure?.0025:.175*e,")"),o.fillRect(0,0,l,n),i.clearRect(0,0,l,n);J.active.length;){let e=J.active.pop(),t=o.createRadialGradient(e.x,e.y,0,e.x,e.y,e.radius);t.addColorStop(.024,"rgba(255, 255, 255, 1)"),t.addColorStop(.125,"rgba(255, 160, 20, 0.2)"),t.addColorStop(.32,"rgba(255, 140, 20, 0.11)"),t.addColorStop(1,"rgba(255, 120, 20, 0)"),o.fillStyle=t,o.fillRect(e.x-e.radius,e.y-e.radius,2*e.radius,2*e.radius),J.returnInstance(e)}o.globalCompositeOperation="lighten",o.lineWidth=Q.drawWidth,o.lineCap=b?"square":"round",i.strokeStyle="#fff",i.lineWidth=1,i.beginPath(),I.forEach(e=>{let t=Q.active[e];o.strokeStyle=e,o.beginPath(),t.forEach(e=>{e.visible&&(o.moveTo(e.x,e.y),o.lineTo(e.prevX,e.prevY),i.moveTo(e.x,e.y),i.lineTo(e.x-1.6*e.speedX,e.y-1.6*e.speedY))}),o.stroke()}),i.stroke(),o.lineWidth=K.drawWidth,o.lineCap="butt",I.forEach(e=>{let t=K.active[e];o.strokeStyle=e,o.beginPath(),t.forEach(e=>{o.moveTo(e.x,e.y),o.lineTo(e.prevX,e.prevY)}),o.stroke()}),Y&&(i.globalAlpha=Y,i.fillStyle=k.Blue,i.fillRect(0,n-6,l*S,6),i.globalAlpha=1),o.setTransform(1,0,0,1,0,0),i.setTransform(1,0,0,1,0,0)}(n)});let Shell=class Shell{launch(e,t){let l=a,n=r,o=n-.45*n,i=n-(o-t*(o-50)),h=Math.pow(.04*i,.64),c=this.comet=Q.add(e*(l-120)+60,n,"string"==typeof this.color&&"random"!==this.color?this.color:k.White,Math.PI,h*(this.horsetail?1.2:1),h*(this.horsetail?100:400));c.heavy=!0,c.spinRadius=s.random(.32,.85),c.sparkFreq=32/y,v&&(c.sparkFreq=8),c.sparkLife=320,c.sparkLifeVariation=3,("willow"===this.glitter||this.fallingLeaves)&&(c.sparkFreq=20/y,c.sparkSpeed=.5,c.sparkLife=500),this.color===L&&(c.sparkColor=k.Gold),Math.random()>.4&&!this.horsetail&&(c.secondColor=L,c.transitionTime=700*Math.pow(Math.random(),1.5)+500),c.onDeath=e=>this.burst(e.x,e.y),Z.playSound("lift")}burst(e,t){let l,a,r,n,o;let i=this.spreadSize/96,h=.25,c=!1;this.crossette&&(a=e=>{c||(Z.playSound("crackleSmall"),c=!0),createParticleArc(Math.random()*w,M,4,.5,t=>{Q.add(e.x,e.y,e.color,t,.6*Math.random()+.75,600)})}),this.crackle&&(a=e=>{c||(Z.playSound("crackle"),c=!0),function(e){let t=v?32:16;createParticleArc(0,M,t,1.8,t=>{K.add(e.x,e.y,k.Gold,t,2.4*Math.pow(Math.random(),.45),300+200*Math.random())})}(e)}),this.floral&&(a=floralEffect),this.fallingLeaves&&(a=fallingLeavesEffect),"light"===this.glitter?(r=400,n=.3,o=300,h=2):"medium"===this.glitter?(r=200,n=.44,o=700,h=2):"heavy"===this.glitter?(r=80,n=.8,o=1400,h=2):"thick"===this.glitter?(r=16,n=v?1.65:1.5,o=1400,h=3):"streamer"===this.glitter?(r=32,n=1.05,o=620,h=2):"willow"===this.glitter&&(r=120,n=.34,o=1400,h=3.8),r/=y;let starFactory=(s,c)=>{let d=this.spreadSize/1800,u=Q.add(e,t,l||randomColor(),s,c*i,this.starLife+Math.random()*this.starLife*this.starLifeVariation,this.horsetail?this.comet&&this.comet.speedX:0,this.horsetail?this.comet&&this.comet.speedY:-d);this.secondColor&&(u.transitionTime=this.starLife*(.05*Math.random()+.32),u.secondColor=this.secondColor),this.strobe&&(u.transitionTime=this.starLife*(.08*Math.random()+.46),u.strobe=!0,u.strobeFreq=20*Math.random()+40,this.strobeColor&&(u.secondColor=this.strobeColor)),u.onDeath=a,this.glitter&&(u.sparkFreq=r,u.sparkSpeed=n,u.sparkLife=o,u.sparkLifeVariation=h,u.sparkColor=this.glitterColor,u.sparkTimer=Math.random()*u.sparkFreq)};if("string"==typeof this.color){if(l="random"===this.color?null:this.color,this.ring){let a=Math.random()*Math.PI,c=.85*Math.pow(Math.random(),2)+.15;createParticleArc(0,M,this.starCount,0,d=>{let u=Math.sin(d)*i*c,p=Math.cos(d)*i,f=s.pointDist(0,0,u,p),m=s.pointAngle(0,0,u,p)+a,g=Q.add(e,t,l,m,f,this.starLife+Math.random()*this.starLife*this.starLifeVariation);this.glitter&&(g.sparkFreq=r,g.sparkSpeed=n,g.sparkLife=o,g.sparkLifeVariation=h,g.sparkColor=this.glitterColor,g.sparkTimer=Math.random()*g.sparkFreq)})}else createBurst(this.starCount,starFactory)}else if(Array.isArray(this.color)){if(.5>Math.random()){let e=Math.random()*Math.PI,t=e+Math.PI,a=Math.PI;l=this.color[0],createBurst(this.starCount,starFactory,e,a),l=this.color[1],createBurst(this.starCount,starFactory,t,a)}else l=this.color[0],createBurst(this.starCount/2,starFactory),l=this.color[1],createBurst(this.starCount/2,starFactory)}else throw Error("Invalid shell color. Expected string or array of strings, but got: "+this.color);if(this.pistil){let l=new Shell({spreadSize:.5*this.spreadSize,starLife:.6*this.starLife,starLifeVariation:this.starLifeVariation,starDensity:1.4,color:this.pistilColor,glitter:"light",glitterColor:this.pistilColor===k.Gold?k.Gold:k.White});l.burst(e,t)}if(this.streamers){let l=new Shell({spreadSize:.9*this.spreadSize,starLife:.8*this.starLife,starLifeVariation:this.starLifeVariation,starCount:Math.floor(Math.max(6,this.spreadSize/45)),color:k.White,glitter:"streamer"});l.burst(e,t)}if(J.add(e,t,this.spreadSize/4),this.comet){let e=Math.min(2,shellSizeSelector()-this.shellSize);Z.playSound("burst",(1-e/2)*.3+.7)}}constructor(e){if(Object.assign(this,e),this.starLifeVariation=e.starLifeVariation||.125,this.color=e.color||randomColor(),this.glitterColor=e.glitterColor||this.color,!this.starCount){let t=e.starDensity||1,l=this.spreadSize/54;this.starCount=Math.max(6,l*l*t)}}};let J={active:[],_pool:[],_new:()=>({}),add(e,t,l){let a=this._pool.pop()||this._new();return a.x=e,a.y=t,a.radius=l,this.active.push(a),a},returnInstance(e){this._pool.push(e)}};function createParticleCollection(){let e={};return _.forEach(t=>{e[t]=[]}),e}let Q={drawWidth:3,airDrag:.98,airDragHeavy:.992,active:createParticleCollection(),_pool:[],_new:()=>({}),add(e,t,l,a,r,n,o,i){let s=this._pool.pop()||this._new();return s.visible=!0,s.heavy=!1,s.x=e,s.y=t,s.prevX=e,s.prevY=t,s.color=l,s.speedX=Math.sin(a)*r+(o||0),s.speedY=Math.cos(a)*r+(i||0),s.life=n,s.fullLife=n,s.spinAngle=Math.random()*M,s.spinSpeed=.8,s.spinRadius=0,s.sparkFreq=0,s.sparkSpeed=1,s.sparkTimer=0,s.sparkColor=l,s.sparkLife=750,s.sparkLifeVariation=.25,s.strobe=!1,this.active[l].push(s),s},returnInstance(e){e.onDeath&&e.onDeath(e),e.onDeath=null,e.secondColor=null,e.transitionTime=0,e.colorChanged=!1,this._pool.push(e)}},K={drawWidth:0,airDrag:.9,active:createParticleCollection(),_pool:[],_new:()=>({}),add(e,t,l,a,r,n){let o=this._pool.pop()||this._new();return o.x=e,o.y=t,o.prevX=e,o.prevY=t,o.color=l,o.speedX=Math.sin(a)*r,o.speedY=Math.cos(a)*r,o.life=n,this.active[l].push(o),o},returnInstance(e){this._pool.push(e)}},Z={baseURL:"/audio/",ctx:new(window.AudioContext||window.webkitAudioContext),sources:{lift:{volume:1,playbackRateMin:.85,playbackRateMax:.95,fileNames:["lift1.mp3","lift2.mp3","lift3.mp3"]},burst:{volume:1,playbackRateMin:.8,playbackRateMax:.9,fileNames:["burst1.mp3","burst2.mp3"]},burstSmall:{volume:.25,playbackRateMin:.8,playbackRateMax:1,fileNames:["burst-sm-1.mp3","burst-sm-2.mp3"]},crackle:{volume:.2,playbackRateMin:1,playbackRateMax:1,fileNames:["crackle1.mp3"]},crackleSmall:{volume:.3,playbackRateMin:1,playbackRateMax:1,fileNames:["crackle-sm-1.mp3"]}},preload(){let e=[];function checkStatus(e){if(e.status>=200&&e.status<300)return e;let t=Error(e.statusText);throw t.response=e,t}let t=Object.keys(this.sources);return t.forEach(t=>{let l=this.sources[t],{fileNames:a}=l,r=[];a.forEach(t=>{let l=this.baseURL+t,a=fetch(l).then(checkStatus).then(e=>e.arrayBuffer()).then(e=>new Promise(t=>{this.ctx.decodeAudioData(e,t)}));r.push(a),e.push(a)}),Promise.all(r).then(e=>{l.buffers=e})}),Promise.all(e)},pauseAll(){this.ctx.suspend()},resumeAll(){this.playSound("lift",0),setTimeout(()=>{this.ctx.resume()},250)},_lastSmallBurstTime:0,playSound(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(t=s.clamp(t,0,1),!canPlaySoundSelector()||S<.95)return;if("burstSmall"===e){let e=Date.now();if(e-this._lastSmallBurstTime<20)return;this._lastSmallBurstTime=e}let l=this.sources[e];if(console.log(l),!l)throw Error('Sound of type "'.concat(e,"\" doesn't exist."));let a=l.volume,r=s.random(l.playbackRateMin,l.playbackRateMax),n=a*t,o=r*(2-t),i=this.ctx.createGain();i.gain.value=n;let h=s.randomChoice(l.buffers);console.log(h);let c=this.ctx.createBufferSource();c.playbackRate.value=o,c.buffer=h,c.connect(i),i.connect(this.ctx.destination),c.start(0)}};function start(){m?init():(!function(e){let t=document.querySelector(".loading-init__status");t&&(t.textContent=e)}("Lighting Fuses"),setTimeout(()=>{Z.preload().then(init,e=>(init(),Promise.reject(e)))},0))}}}]);